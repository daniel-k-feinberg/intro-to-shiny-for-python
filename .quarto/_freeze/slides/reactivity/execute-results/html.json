{
  "hash": "5d130b1da730abd278ed09438bf4e039",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Reactivity\"\ntitle-slide-attributes: \n  data-background-image:  images/shiny-for-python-newcastle.jpg\n  data-background-position: bottom left\n  data-background-size: cover\nformat:\n  positconfslides-revealjs: \n    incremental: false\n    chalkboard: true\n    slide-number: c/t\n    code-copy: true\n    center-title-slide: false\n    highlight-style: a11y\n    width: \"1600\"\n    height: \"900\"\n    css: \"styles.css\"\n    filters:\n      - positconfslides\n---\n\n\n\n# Reactivity overview\n\n\n## How did Shiny do that?\n\n```{shinylive-python}\n#| standalone: true\n#| components: [viewer]\n#| layout: horizontal\n#| viewerHeight: 500\nfrom shiny import App, render, ui\nimport pandas as pd\nfrom pathlib import Path\nfrom plots import dist_plot, scatter_plot\n\ninfile = Path(__file__).parent / \"penguins.csv\"\npenguins = pd.read_csv(infile)\n\napp_ui = ui.page_fluid(\n    ui.panel_title(\"Hello Penguins!\"),\n    ui.layout_sidebar(\n        ui.panel_sidebar(\n            ui.input_slider(\n                \"mass\",\n                \"Mass\",\n                2000,\n                8000,\n                6000,\n            ),\n            ui.input_checkbox(\"trend\", \"Add trendline\"),\n        ),\n        ui.panel_main(\n            ui.output_plot(\"scatter\"),\n            ui.output_data_frame(\"table\"),\n            ui.output_plot(\"dist\"),\n        ),\n    ),\n)\n\n\ndef server(input, output, session):\n    @output\n    @render.data_frame\n    def table():\n        df = penguins.copy()\n        filtered = df.loc[df[\"body_mass\"] < input.mass()]\n        summary = (\n            filtered.set_index(\"species\")\n            .groupby(level=\"species\")\n            .agg({\"bill_length\": \"mean\", \"bill_depth\": \"mean\"})\n            .reset_index()\n        )\n        return summary\n\n    @output\n    @render.plot\n    def dist():\n        df = penguins.copy()\n        filtered = df.loc[df[\"body_mass\"] < input.mass()]\n        return dist_plot(filtered)\n\n    @output\n    @render.plot\n    def scatter():\n        df = penguins.copy()\n        filtered = df.loc[df[\"body_mass\"] < input.mass()]\n        return scatter_plot(filtered, input.trend())\n\n\napp = App(app_ui, server)\n\n## file: plots.py\nfrom plotnine import ggplot, geom_density, aes, theme_light, geom_point, stat_smooth\n\n\ndef dist_plot(df):\n    plot = (\n        ggplot(df, aes(x=\"body_mass\", fill=\"species\"))\n        + geom_density(alpha=0.2)\n        + theme_light()\n    )\n    return plot\n\n\ndef scatter_plot(df, trend_line=False):\n    plot = (\n        ggplot(\n            df,\n            aes(\n                x=\"bill_length\",\n                y=\"bill_depth\",\n                color=\"species\",\n                group=\"species\",\n            ),\n        )\n        + geom_point()\n        + theme_light()\n    )\n\n    if trend_line:\n        plot = plot + stat_smooth()\n\n    return plot\n\n## file: penguins.csv\nspecies,island,bill_length,bill_depth,flipper_length,body_mass,sex,year\nAdelie,Torgersen,39.1,18.7,181,3750,male,2007\nAdelie,Torgersen,39.5,17.4,186,3800,female,2007\nAdelie,Torgersen,40.3,18,195,3250,female,2007\nAdelie,Torgersen,NA,NA,NA,NA,NA,2007\nAdelie,Torgersen,36.7,19.3,193,3450,female,2007\nAdelie,Torgersen,39.3,20.6,190,3650,male,2007\nAdelie,Torgersen,38.9,17.8,181,3625,female,2007\nAdelie,Torgersen,39.2,19.6,195,4675,male,2007\nAdelie,Torgersen,34.1,18.1,193,3475,NA,2007\nAdelie,Torgersen,42,20.2,190,4250,NA,2007\nAdelie,Torgersen,37.8,17.1,186,3300,NA,2007\nAdelie,Torgersen,37.8,17.3,180,3700,NA,2007\nAdelie,Torgersen,41.1,17.6,182,3200,female,2007\nAdelie,Torgersen,38.6,21.2,191,3800,male,2007\nAdelie,Torgersen,34.6,21.1,198,4400,male,2007\nAdelie,Torgersen,36.6,17.8,185,3700,female,2007\nAdelie,Torgersen,38.7,19,195,3450,female,2007\nAdelie,Torgersen,42.5,20.7,197,4500,male,2007\nAdelie,Torgersen,34.4,18.4,184,3325,female,2007\nAdelie,Torgersen,46,21.5,194,4200,male,2007\nAdelie,Biscoe,37.8,18.3,174,3400,female,2007\nAdelie,Biscoe,37.7,18.7,180,3600,male,2007\nAdelie,Biscoe,35.9,19.2,189,3800,female,2007\nAdelie,Biscoe,38.2,18.1,185,3950,male,2007\nAdelie,Biscoe,38.8,17.2,180,3800,male,2007\nAdelie,Biscoe,35.3,18.9,187,3800,female,2007\nAdelie,Biscoe,40.6,18.6,183,3550,male,2007\nAdelie,Biscoe,40.5,17.9,187,3200,female,2007\nAdelie,Biscoe,37.9,18.6,172,3150,female,2007\nAdelie,Biscoe,40.5,18.9,180,3950,male,2007\nAdelie,Dream,39.5,16.7,178,3250,female,2007\nAdelie,Dream,37.2,18.1,178,3900,male,2007\nAdelie,Dream,39.5,17.8,188,3300,female,2007\nAdelie,Dream,40.9,18.9,184,3900,male,2007\nAdelie,Dream,36.4,17,195,3325,female,2007\nAdelie,Dream,39.2,21.1,196,4150,male,2007\nAdelie,Dream,38.8,20,190,3950,male,2007\nAdelie,Dream,42.2,18.5,180,3550,female,2007\nAdelie,Dream,37.6,19.3,181,3300,female,2007\nAdelie,Dream,39.8,19.1,184,4650,male,2007\nAdelie,Dream,36.5,18,182,3150,female,2007\nAdelie,Dream,40.8,18.4,195,3900,male,2007\nAdelie,Dream,36,18.5,186,3100,female,2007\nAdelie,Dream,44.1,19.7,196,4400,male,2007\nAdelie,Dream,37,16.9,185,3000,female,2007\nAdelie,Dream,39.6,18.8,190,4600,male,2007\nAdelie,Dream,41.1,19,182,3425,male,2007\nAdelie,Dream,37.5,18.9,179,2975,NA,2007\nAdelie,Dream,36,17.9,190,3450,female,2007\nAdelie,Dream,42.3,21.2,191,4150,male,2007\nAdelie,Biscoe,39.6,17.7,186,3500,female,2008\nAdelie,Biscoe,40.1,18.9,188,4300,male,2008\nAdelie,Biscoe,35,17.9,190,3450,female,2008\nAdelie,Biscoe,42,19.5,200,4050,male,2008\nAdelie,Biscoe,34.5,18.1,187,2900,female,2008\nAdelie,Biscoe,41.4,18.6,191,3700,male,2008\nAdelie,Biscoe,39,17.5,186,3550,female,2008\nAdelie,Biscoe,40.6,18.8,193,3800,male,2008\nAdelie,Biscoe,36.5,16.6,181,2850,female,2008\nAdelie,Biscoe,37.6,19.1,194,3750,male,2008\nAdelie,Biscoe,35.7,16.9,185,3150,female,2008\nAdelie,Biscoe,41.3,21.1,195,4400,male,2008\nAdelie,Biscoe,37.6,17,185,3600,female,2008\nAdelie,Biscoe,41.1,18.2,192,4050,male,2008\nAdelie,Biscoe,36.4,17.1,184,2850,female,2008\nAdelie,Biscoe,41.6,18,192,3950,male,2008\nAdelie,Biscoe,35.5,16.2,195,3350,female,2008\nAdelie,Biscoe,41.1,19.1,188,4100,male,2008\nAdelie,Torgersen,35.9,16.6,190,3050,female,2008\nAdelie,Torgersen,41.8,19.4,198,4450,male,2008\nAdelie,Torgersen,33.5,19,190,3600,female,2008\nAdelie,Torgersen,39.7,18.4,190,3900,male,2008\nAdelie,Torgersen,39.6,17.2,196,3550,female,2008\nAdelie,Torgersen,45.8,18.9,197,4150,male,2008\nAdelie,Torgersen,35.5,17.5,190,3700,female,2008\nAdelie,Torgersen,42.8,18.5,195,4250,male,2008\nAdelie,Torgersen,40.9,16.8,191,3700,female,2008\nAdelie,Torgersen,37.2,19.4,184,3900,male,2008\nAdelie,Torgersen,36.2,16.1,187,3550,female,2008\nAdelie,Torgersen,42.1,19.1,195,4000,male,2008\nAdelie,Torgersen,34.6,17.2,189,3200,female,2008\nAdelie,Torgersen,42.9,17.6,196,4700,male,2008\nAdelie,Torgersen,36.7,18.8,187,3800,female,2008\nAdelie,Torgersen,35.1,19.4,193,4200,male,2008\nAdelie,Dream,37.3,17.8,191,3350,female,2008\nAdelie,Dream,41.3,20.3,194,3550,male,2008\nAdelie,Dream,36.3,19.5,190,3800,male,2008\nAdelie,Dream,36.9,18.6,189,3500,female,2008\nAdelie,Dream,38.3,19.2,189,3950,male,2008\nAdelie,Dream,38.9,18.8,190,3600,female,2008\nAdelie,Dream,35.7,18,202,3550,female,2008\nAdelie,Dream,41.1,18.1,205,4300,male,2008\nAdelie,Dream,34,17.1,185,3400,female,2008\nAdelie,Dream,39.6,18.1,186,4450,male,2008\nAdelie,Dream,36.2,17.3,187,3300,female,2008\nAdelie,Dream,40.8,18.9,208,4300,male,2008\nAdelie,Dream,38.1,18.6,190,3700,female,2008\nAdelie,Dream,40.3,18.5,196,4350,male,2008\nAdelie,Dream,33.1,16.1,178,2900,female,2008\nAdelie,Dream,43.2,18.5,192,4100,male,2008\nAdelie,Biscoe,35,17.9,192,3725,female,2009\nAdelie,Biscoe,41,20,203,4725,male,2009\nAdelie,Biscoe,37.7,16,183,3075,female,2009\nAdelie,Biscoe,37.8,20,190,4250,male,2009\nAdelie,Biscoe,37.9,18.6,193,2925,female,2009\nAdelie,Biscoe,39.7,18.9,184,3550,male,2009\nAdelie,Biscoe,38.6,17.2,199,3750,female,2009\nAdelie,Biscoe,38.2,20,190,3900,male,2009\nAdelie,Biscoe,38.1,17,181,3175,female,2009\nAdelie,Biscoe,43.2,19,197,4775,male,2009\nAdelie,Biscoe,38.1,16.5,198,3825,female,2009\nAdelie,Biscoe,45.6,20.3,191,4600,male,2009\nAdelie,Biscoe,39.7,17.7,193,3200,female,2009\nAdelie,Biscoe,42.2,19.5,197,4275,male,2009\nAdelie,Biscoe,39.6,20.7,191,3900,female,2009\nAdelie,Biscoe,42.7,18.3,196,4075,male,2009\nAdelie,Torgersen,38.6,17,188,2900,female,2009\nAdelie,Torgersen,37.3,20.5,199,3775,male,2009\nAdelie,Torgersen,35.7,17,189,3350,female,2009\nAdelie,Torgersen,41.1,18.6,189,3325,male,2009\nAdelie,Torgersen,36.2,17.2,187,3150,female,2009\nAdelie,Torgersen,37.7,19.8,198,3500,male,2009\nAdelie,Torgersen,40.2,17,176,3450,female,2009\nAdelie,Torgersen,41.4,18.5,202,3875,male,2009\nAdelie,Torgersen,35.2,15.9,186,3050,female,2009\nAdelie,Torgersen,40.6,19,199,4000,male,2009\nAdelie,Torgersen,38.8,17.6,191,3275,female,2009\nAdelie,Torgersen,41.5,18.3,195,4300,male,2009\nAdelie,Torgersen,39,17.1,191,3050,female,2009\nAdelie,Torgersen,44.1,18,210,4000,male,2009\nAdelie,Torgersen,38.5,17.9,190,3325,female,2009\nAdelie,Torgersen,43.1,19.2,197,3500,male,2009\nAdelie,Dream,36.8,18.5,193,3500,female,2009\nAdelie,Dream,37.5,18.5,199,4475,male,2009\nAdelie,Dream,38.1,17.6,187,3425,female,2009\nAdelie,Dream,41.1,17.5,190,3900,male,2009\nAdelie,Dream,35.6,17.5,191,3175,female,2009\nAdelie,Dream,40.2,20.1,200,3975,male,2009\nAdelie,Dream,37,16.5,185,3400,female,2009\nAdelie,Dream,39.7,17.9,193,4250,male,2009\nAdelie,Dream,40.2,17.1,193,3400,female,2009\nAdelie,Dream,40.6,17.2,187,3475,male,2009\nAdelie,Dream,32.1,15.5,188,3050,female,2009\nAdelie,Dream,40.7,17,190,3725,male,2009\nAdelie,Dream,37.3,16.8,192,3000,female,2009\nAdelie,Dream,39,18.7,185,3650,male,2009\nAdelie,Dream,39.2,18.6,190,4250,male,2009\nAdelie,Dream,36.6,18.4,184,3475,female,2009\nAdelie,Dream,36,17.8,195,3450,female,2009\nAdelie,Dream,37.8,18.1,193,3750,male,2009\nAdelie,Dream,36,17.1,187,3700,female,2009\nAdelie,Dream,41.5,18.5,201,4000,male,2009\nGentoo,Biscoe,46.1,13.2,211,4500,female,2007\nGentoo,Biscoe,50,16.3,230,5700,male,2007\nGentoo,Biscoe,48.7,14.1,210,4450,female,2007\nGentoo,Biscoe,50,15.2,218,5700,male,2007\nGentoo,Biscoe,47.6,14.5,215,5400,male,2007\nGentoo,Biscoe,46.5,13.5,210,4550,female,2007\nGentoo,Biscoe,45.4,14.6,211,4800,female,2007\nGentoo,Biscoe,46.7,15.3,219,5200,male,2007\nGentoo,Biscoe,43.3,13.4,209,4400,female,2007\nGentoo,Biscoe,46.8,15.4,215,5150,male,2007\nGentoo,Biscoe,40.9,13.7,214,4650,female,2007\nGentoo,Biscoe,49,16.1,216,5550,male,2007\nGentoo,Biscoe,45.5,13.7,214,4650,female,2007\nGentoo,Biscoe,48.4,14.6,213,5850,male,2007\nGentoo,Biscoe,45.8,14.6,210,4200,female,2007\nGentoo,Biscoe,49.3,15.7,217,5850,male,2007\nGentoo,Biscoe,42,13.5,210,4150,female,2007\nGentoo,Biscoe,49.2,15.2,221,6300,male,2007\nGentoo,Biscoe,46.2,14.5,209,4800,female,2007\nGentoo,Biscoe,48.7,15.1,222,5350,male,2007\nGentoo,Biscoe,50.2,14.3,218,5700,male,2007\nGentoo,Biscoe,45.1,14.5,215,5000,female,2007\nGentoo,Biscoe,46.5,14.5,213,4400,female,2007\nGentoo,Biscoe,46.3,15.8,215,5050,male,2007\nGentoo,Biscoe,42.9,13.1,215,5000,female,2007\nGentoo,Biscoe,46.1,15.1,215,5100,male,2007\nGentoo,Biscoe,44.5,14.3,216,4100,NA,2007\nGentoo,Biscoe,47.8,15,215,5650,male,2007\nGentoo,Biscoe,48.2,14.3,210,4600,female,2007\nGentoo,Biscoe,50,15.3,220,5550,male,2007\nGentoo,Biscoe,47.3,15.3,222,5250,male,2007\nGentoo,Biscoe,42.8,14.2,209,4700,female,2007\nGentoo,Biscoe,45.1,14.5,207,5050,female,2007\nGentoo,Biscoe,59.6,17,230,6050,male,2007\nGentoo,Biscoe,49.1,14.8,220,5150,female,2008\nGentoo,Biscoe,48.4,16.3,220,5400,male,2008\nGentoo,Biscoe,42.6,13.7,213,4950,female,2008\nGentoo,Biscoe,44.4,17.3,219,5250,male,2008\nGentoo,Biscoe,44,13.6,208,4350,female,2008\nGentoo,Biscoe,48.7,15.7,208,5350,male,2008\nGentoo,Biscoe,42.7,13.7,208,3950,female,2008\nGentoo,Biscoe,49.6,16,225,5700,male,2008\nGentoo,Biscoe,45.3,13.7,210,4300,female,2008\nGentoo,Biscoe,49.6,15,216,4750,male,2008\nGentoo,Biscoe,50.5,15.9,222,5550,male,2008\nGentoo,Biscoe,43.6,13.9,217,4900,female,2008\nGentoo,Biscoe,45.5,13.9,210,4200,female,2008\nGentoo,Biscoe,50.5,15.9,225,5400,male,2008\nGentoo,Biscoe,44.9,13.3,213,5100,female,2008\nGentoo,Biscoe,45.2,15.8,215,5300,male,2008\nGentoo,Biscoe,46.6,14.2,210,4850,female,2008\nGentoo,Biscoe,48.5,14.1,220,5300,male,2008\nGentoo,Biscoe,45.1,14.4,210,4400,female,2008\nGentoo,Biscoe,50.1,15,225,5000,male,2008\nGentoo,Biscoe,46.5,14.4,217,4900,female,2008\nGentoo,Biscoe,45,15.4,220,5050,male,2008\nGentoo,Biscoe,43.8,13.9,208,4300,female,2008\nGentoo,Biscoe,45.5,15,220,5000,male,2008\nGentoo,Biscoe,43.2,14.5,208,4450,female,2008\nGentoo,Biscoe,50.4,15.3,224,5550,male,2008\nGentoo,Biscoe,45.3,13.8,208,4200,female,2008\nGentoo,Biscoe,46.2,14.9,221,5300,male,2008\nGentoo,Biscoe,45.7,13.9,214,4400,female,2008\nGentoo,Biscoe,54.3,15.7,231,5650,male,2008\nGentoo,Biscoe,45.8,14.2,219,4700,female,2008\nGentoo,Biscoe,49.8,16.8,230,5700,male,2008\nGentoo,Biscoe,46.2,14.4,214,4650,NA,2008\nGentoo,Biscoe,49.5,16.2,229,5800,male,2008\nGentoo,Biscoe,43.5,14.2,220,4700,female,2008\nGentoo,Biscoe,50.7,15,223,5550,male,2008\nGentoo,Biscoe,47.7,15,216,4750,female,2008\nGentoo,Biscoe,46.4,15.6,221,5000,male,2008\nGentoo,Biscoe,48.2,15.6,221,5100,male,2008\nGentoo,Biscoe,46.5,14.8,217,5200,female,2008\nGentoo,Biscoe,46.4,15,216,4700,female,2008\nGentoo,Biscoe,48.6,16,230,5800,male,2008\nGentoo,Biscoe,47.5,14.2,209,4600,female,2008\nGentoo,Biscoe,51.1,16.3,220,6000,male,2008\nGentoo,Biscoe,45.2,13.8,215,4750,female,2008\nGentoo,Biscoe,45.2,16.4,223,5950,male,2008\nGentoo,Biscoe,49.1,14.5,212,4625,female,2009\nGentoo,Biscoe,52.5,15.6,221,5450,male,2009\nGentoo,Biscoe,47.4,14.6,212,4725,female,2009\nGentoo,Biscoe,50,15.9,224,5350,male,2009\nGentoo,Biscoe,44.9,13.8,212,4750,female,2009\nGentoo,Biscoe,50.8,17.3,228,5600,male,2009\nGentoo,Biscoe,43.4,14.4,218,4600,female,2009\nGentoo,Biscoe,51.3,14.2,218,5300,male,2009\nGentoo,Biscoe,47.5,14,212,4875,female,2009\nGentoo,Biscoe,52.1,17,230,5550,male,2009\nGentoo,Biscoe,47.5,15,218,4950,female,2009\nGentoo,Biscoe,52.2,17.1,228,5400,male,2009\nGentoo,Biscoe,45.5,14.5,212,4750,female,2009\nGentoo,Biscoe,49.5,16.1,224,5650,male,2009\nGentoo,Biscoe,44.5,14.7,214,4850,female,2009\nGentoo,Biscoe,50.8,15.7,226,5200,male,2009\nGentoo,Biscoe,49.4,15.8,216,4925,male,2009\nGentoo,Biscoe,46.9,14.6,222,4875,female,2009\nGentoo,Biscoe,48.4,14.4,203,4625,female,2009\nGentoo,Biscoe,51.1,16.5,225,5250,male,2009\nGentoo,Biscoe,48.5,15,219,4850,female,2009\nGentoo,Biscoe,55.9,17,228,5600,male,2009\nGentoo,Biscoe,47.2,15.5,215,4975,female,2009\nGentoo,Biscoe,49.1,15,228,5500,male,2009\nGentoo,Biscoe,47.3,13.8,216,4725,NA,2009\nGentoo,Biscoe,46.8,16.1,215,5500,male,2009\nGentoo,Biscoe,41.7,14.7,210,4700,female,2009\nGentoo,Biscoe,53.4,15.8,219,5500,male,2009\nGentoo,Biscoe,43.3,14,208,4575,female,2009\nGentoo,Biscoe,48.1,15.1,209,5500,male,2009\nGentoo,Biscoe,50.5,15.2,216,5000,female,2009\nGentoo,Biscoe,49.8,15.9,229,5950,male,2009\nGentoo,Biscoe,43.5,15.2,213,4650,female,2009\nGentoo,Biscoe,51.5,16.3,230,5500,male,2009\nGentoo,Biscoe,46.2,14.1,217,4375,female,2009\nGentoo,Biscoe,55.1,16,230,5850,male,2009\nGentoo,Biscoe,44.5,15.7,217,4875,NA,2009\nGentoo,Biscoe,48.8,16.2,222,6000,male,2009\nGentoo,Biscoe,47.2,13.7,214,4925,female,2009\nGentoo,Biscoe,NA,NA,NA,NA,NA,2009\nGentoo,Biscoe,46.8,14.3,215,4850,female,2009\nGentoo,Biscoe,50.4,15.7,222,5750,male,2009\nGentoo,Biscoe,45.2,14.8,212,5200,female,2009\nGentoo,Biscoe,49.9,16.1,213,5400,male,2009\nChinstrap,Dream,46.5,17.9,192,3500,female,2007\nChinstrap,Dream,50,19.5,196,3900,male,2007\nChinstrap,Dream,51.3,19.2,193,3650,male,2007\nChinstrap,Dream,45.4,18.7,188,3525,female,2007\nChinstrap,Dream,52.7,19.8,197,3725,male,2007\nChinstrap,Dream,45.2,17.8,198,3950,female,2007\nChinstrap,Dream,46.1,18.2,178,3250,female,2007\nChinstrap,Dream,51.3,18.2,197,3750,male,2007\nChinstrap,Dream,46,18.9,195,4150,female,2007\nChinstrap,Dream,51.3,19.9,198,3700,male,2007\nChinstrap,Dream,46.6,17.8,193,3800,female,2007\nChinstrap,Dream,51.7,20.3,194,3775,male,2007\nChinstrap,Dream,47,17.3,185,3700,female,2007\nChinstrap,Dream,52,18.1,201,4050,male,2007\nChinstrap,Dream,45.9,17.1,190,3575,female,2007\nChinstrap,Dream,50.5,19.6,201,4050,male,2007\nChinstrap,Dream,50.3,20,197,3300,male,2007\nChinstrap,Dream,58,17.8,181,3700,female,2007\nChinstrap,Dream,46.4,18.6,190,3450,female,2007\nChinstrap,Dream,49.2,18.2,195,4400,male,2007\nChinstrap,Dream,42.4,17.3,181,3600,female,2007\nChinstrap,Dream,48.5,17.5,191,3400,male,2007\nChinstrap,Dream,43.2,16.6,187,2900,female,2007\nChinstrap,Dream,50.6,19.4,193,3800,male,2007\nChinstrap,Dream,46.7,17.9,195,3300,female,2007\nChinstrap,Dream,52,19,197,4150,male,2007\nChinstrap,Dream,50.5,18.4,200,3400,female,2008\nChinstrap,Dream,49.5,19,200,3800,male,2008\nChinstrap,Dream,46.4,17.8,191,3700,female,2008\nChinstrap,Dream,52.8,20,205,4550,male,2008\nChinstrap,Dream,40.9,16.6,187,3200,female,2008\nChinstrap,Dream,54.2,20.8,201,4300,male,2008\nChinstrap,Dream,42.5,16.7,187,3350,female,2008\nChinstrap,Dream,51,18.8,203,4100,male,2008\nChinstrap,Dream,49.7,18.6,195,3600,male,2008\nChinstrap,Dream,47.5,16.8,199,3900,female,2008\nChinstrap,Dream,47.6,18.3,195,3850,female,2008\nChinstrap,Dream,52,20.7,210,4800,male,2008\nChinstrap,Dream,46.9,16.6,192,2700,female,2008\nChinstrap,Dream,53.5,19.9,205,4500,male,2008\nChinstrap,Dream,49,19.5,210,3950,male,2008\nChinstrap,Dream,46.2,17.5,187,3650,female,2008\nChinstrap,Dream,50.9,19.1,196,3550,male,2008\nChinstrap,Dream,45.5,17,196,3500,female,2008\nChinstrap,Dream,50.9,17.9,196,3675,female,2009\nChinstrap,Dream,50.8,18.5,201,4450,male,2009\nChinstrap,Dream,50.1,17.9,190,3400,female,2009\nChinstrap,Dream,49,19.6,212,4300,male,2009\nChinstrap,Dream,51.5,18.7,187,3250,male,2009\nChinstrap,Dream,49.8,17.3,198,3675,female,2009\nChinstrap,Dream,48.1,16.4,199,3325,female,2009\nChinstrap,Dream,51.4,19,201,3950,male,2009\nChinstrap,Dream,45.7,17.3,193,3600,female,2009\nChinstrap,Dream,50.7,19.7,203,4050,male,2009\nChinstrap,Dream,42.5,17.3,187,3350,female,2009\nChinstrap,Dream,52.2,18.8,197,3450,male,2009\nChinstrap,Dream,45.2,16.6,191,3250,female,2009\nChinstrap,Dream,49.3,19.9,203,4050,male,2009\nChinstrap,Dream,50.2,18.8,202,3800,male,2009\nChinstrap,Dream,45.6,19.4,194,3525,female,2009\nChinstrap,Dream,51.9,19.5,206,3950,male,2009\nChinstrap,Dream,46.8,16.5,189,3650,female,2009\nChinstrap,Dream,45.7,17,195,3650,female,2009\nChinstrap,Dream,55.8,19.8,207,4000,male,2009\nChinstrap,Dream,43.5,18.1,202,3400,female,2009\nChinstrap,Dream,49.6,18.2,193,3775,male,2009\nChinstrap,Dream,50.8,19,210,4100,male,2009\nChinstrap,Dream,50.2,18.7,198,3775,female,2009\n\n## file: README\n1) Add a second plot output to the apps which shows a scatter plot of Bill Depth to Bill Length, there's a plotting function in `plots.py` which provides one implementation.\n2) Add a checkbox which adds a line of best fit to the plot. \n```\n\n\n## How did Shiny do that?\n\n- We told Shiny _what_ to do\n- We didn't tell Shiny _when_ to do it\n\n## How do other frameworks work?\n\n- Streamlit: re-render everything everywhere all the time\n- Dash/Panel/Gradio: Define callback functions\n\n## Event driven programming\n\n- You have to do it\n- Easy to get wrong\n- Hard to tell when you've gotten it wrong\n\n## What's a better way?\n\n::: {.v-center-container}\n- Infer the relationships between components \n- Build a computation graph\n:::\n\n## Does that really work?\n\n- You're not wrong to find this suspicious\n- \"Does Shiny infer relationships by analyizing the source code?\" No--lots of ways that would break down!\n- For this to work, the inference has to be 100% reliable\n\n## It really works\n\n- We have 10 years of real-world experience with this form of reactivity\n- The underlying mechanism is simple, reliable, and intuitive\n- Not static analysis, but rather, runtime tracing\n- Originally inspired by Meteor.js\n\n## Outputs and recipes\n\n\n```{.python code-line-numbers=\"5,12\"}\nfrom shiny import Inputs, Outputs, Session, App, render, ui\n\napp_ui = ui.page_fluid(\n    ui.input_slider(\"n\", \"N\", 0, 100, 20),\n    ui.output_text_verbatim(\"txt\"),\n)\n\ndef server(input: Inputs, output: Outputs, session: Session):\n    @output\n    @render.text\n    def txt():\n        return f\"n*2 is {input.n() * 2}\"\n\n\napp = App(app_ui, server)\n```\n\n## Recipes and inputs\n\n```{.python code-line-numbers=\"4,13\"}\nfrom shiny import Inputs, Outputs, Session, App, render, ui\n\napp_ui = ui.page_fluid(\n    ui.input_slider(\"n\", \"N\", 0, 100, 20),\n    ui.output_text_verbatim(\"txt\"),\n)\n\n\ndef server(input: Inputs, output: Outputs, session: Session):\n    @output\n    @render.text\n    def txt():\n        return f\"n*2 is {input.n() * 2}\"\n\n\napp = App(app_ui, server)\n```\n\n\n## Reactive graph\n\n\n```{mermaid}\n%%| fig-height: 20\nflowchart TD\n  S[Slider] --> R{Recipe}\n  R --> Sc((Text))\n```\n\n\n## Reactive graph\n\n\n```{mermaid}\nflowchart TD\n  S[Slider] --> Sc((Text))\n```\n\n\n## Declarative programming\n\n- Tell Shiny how each output should be filled\n- Trust that the framework will keep everything up-to-date\n- You're setting the menu, not doing the cooking\n\n## Event-driven programming\n![](images/carmy-yelling.webp)\n\n## Reactive programming\n![](images/carmy-whites.png)\n\n## Your turn\n\nDraw the graph of this application\n\n```{shinylive-python}\n#| standalone: true\n#| components: [viewer]\n#| layout: horizontal\n#| viewerHeight: 600\nfrom shiny import App, render, ui\nimport pandas as pd\nfrom pathlib import Path\nfrom plots import dist_plot, scatter_plot\n\ninfile = Path(__file__).parent / \"penguins.csv\"\npenguins = pd.read_csv(infile)\n\napp_ui = ui.page_fluid(\n    ui.panel_title(\"Hello Penguins!\"),\n    ui.layout_sidebar(\n        ui.panel_sidebar(\n            ui.input_slider(\n                \"mass\",\n                \"Mass\",\n                2000,\n                8000,\n                6000,\n            ),\n            ui.input_checkbox(\"trend\", \"Add trendline\"),\n        ),\n        ui.panel_main(\n            ui.output_plot(\"scatter\"),\n            ui.output_data_frame(\"table\"),\n            ui.output_plot(\"dist\"),\n        ),\n    ),\n)\n\n\ndef server(input, output, session):\n    @output\n    @render.data_frame\n    def table():\n        df = penguins.copy()\n        filtered = df.loc[df[\"body_mass\"] < input.mass()]\n        summary = (\n            filtered.set_index(\"species\")\n            .groupby(level=\"species\")\n            .agg({\"bill_length\": \"mean\", \"bill_depth\": \"mean\"})\n            .reset_index()\n        )\n        return summary\n\n    @output\n    @render.plot\n    def dist():\n        df = penguins.copy()\n        filtered = df.loc[df[\"body_mass\"] < input.mass()]\n        return dist_plot(filtered)\n\n    @output\n    @render.plot\n    def scatter():\n        df = penguins.copy()\n        filtered = df.loc[df[\"body_mass\"] < input.mass()]\n        return scatter_plot(filtered, input.trend())\n\n\napp = App(app_ui, server)\n\n## file: plots.py\nfrom plotnine import ggplot, geom_density, aes, theme_light, geom_point, stat_smooth\n\n\ndef dist_plot(df):\n    plot = (\n        ggplot(df, aes(x=\"body_mass\", fill=\"species\"))\n        + geom_density(alpha=0.2)\n        + theme_light()\n    )\n    return plot\n\n\ndef scatter_plot(df, trend_line=False):\n    plot = (\n        ggplot(\n            df,\n            aes(\n                x=\"bill_length\",\n                y=\"bill_depth\",\n                color=\"species\",\n                group=\"species\",\n            ),\n        )\n        + geom_point()\n        + theme_light()\n    )\n\n    if trend_line:\n        plot = plot + stat_smooth()\n\n    return plot\n\n## file: penguins.csv\nspecies,island,bill_length,bill_depth,flipper_length,body_mass,sex,year\nAdelie,Torgersen,39.1,18.7,181,3750,male,2007\nAdelie,Torgersen,39.5,17.4,186,3800,female,2007\nAdelie,Torgersen,40.3,18,195,3250,female,2007\nAdelie,Torgersen,NA,NA,NA,NA,NA,2007\nAdelie,Torgersen,36.7,19.3,193,3450,female,2007\nAdelie,Torgersen,39.3,20.6,190,3650,male,2007\nAdelie,Torgersen,38.9,17.8,181,3625,female,2007\nAdelie,Torgersen,39.2,19.6,195,4675,male,2007\nAdelie,Torgersen,34.1,18.1,193,3475,NA,2007\nAdelie,Torgersen,42,20.2,190,4250,NA,2007\nAdelie,Torgersen,37.8,17.1,186,3300,NA,2007\nAdelie,Torgersen,37.8,17.3,180,3700,NA,2007\nAdelie,Torgersen,41.1,17.6,182,3200,female,2007\nAdelie,Torgersen,38.6,21.2,191,3800,male,2007\nAdelie,Torgersen,34.6,21.1,198,4400,male,2007\nAdelie,Torgersen,36.6,17.8,185,3700,female,2007\nAdelie,Torgersen,38.7,19,195,3450,female,2007\nAdelie,Torgersen,42.5,20.7,197,4500,male,2007\nAdelie,Torgersen,34.4,18.4,184,3325,female,2007\nAdelie,Torgersen,46,21.5,194,4200,male,2007\nAdelie,Biscoe,37.8,18.3,174,3400,female,2007\nAdelie,Biscoe,37.7,18.7,180,3600,male,2007\nAdelie,Biscoe,35.9,19.2,189,3800,female,2007\nAdelie,Biscoe,38.2,18.1,185,3950,male,2007\nAdelie,Biscoe,38.8,17.2,180,3800,male,2007\nAdelie,Biscoe,35.3,18.9,187,3800,female,2007\nAdelie,Biscoe,40.6,18.6,183,3550,male,2007\nAdelie,Biscoe,40.5,17.9,187,3200,female,2007\nAdelie,Biscoe,37.9,18.6,172,3150,female,2007\nAdelie,Biscoe,40.5,18.9,180,3950,male,2007\nAdelie,Dream,39.5,16.7,178,3250,female,2007\nAdelie,Dream,37.2,18.1,178,3900,male,2007\nAdelie,Dream,39.5,17.8,188,3300,female,2007\nAdelie,Dream,40.9,18.9,184,3900,male,2007\nAdelie,Dream,36.4,17,195,3325,female,2007\nAdelie,Dream,39.2,21.1,196,4150,male,2007\nAdelie,Dream,38.8,20,190,3950,male,2007\nAdelie,Dream,42.2,18.5,180,3550,female,2007\nAdelie,Dream,37.6,19.3,181,3300,female,2007\nAdelie,Dream,39.8,19.1,184,4650,male,2007\nAdelie,Dream,36.5,18,182,3150,female,2007\nAdelie,Dream,40.8,18.4,195,3900,male,2007\nAdelie,Dream,36,18.5,186,3100,female,2007\nAdelie,Dream,44.1,19.7,196,4400,male,2007\nAdelie,Dream,37,16.9,185,3000,female,2007\nAdelie,Dream,39.6,18.8,190,4600,male,2007\nAdelie,Dream,41.1,19,182,3425,male,2007\nAdelie,Dream,37.5,18.9,179,2975,NA,2007\nAdelie,Dream,36,17.9,190,3450,female,2007\nAdelie,Dream,42.3,21.2,191,4150,male,2007\nAdelie,Biscoe,39.6,17.7,186,3500,female,2008\nAdelie,Biscoe,40.1,18.9,188,4300,male,2008\nAdelie,Biscoe,35,17.9,190,3450,female,2008\nAdelie,Biscoe,42,19.5,200,4050,male,2008\nAdelie,Biscoe,34.5,18.1,187,2900,female,2008\nAdelie,Biscoe,41.4,18.6,191,3700,male,2008\nAdelie,Biscoe,39,17.5,186,3550,female,2008\nAdelie,Biscoe,40.6,18.8,193,3800,male,2008\nAdelie,Biscoe,36.5,16.6,181,2850,female,2008\nAdelie,Biscoe,37.6,19.1,194,3750,male,2008\nAdelie,Biscoe,35.7,16.9,185,3150,female,2008\nAdelie,Biscoe,41.3,21.1,195,4400,male,2008\nAdelie,Biscoe,37.6,17,185,3600,female,2008\nAdelie,Biscoe,41.1,18.2,192,4050,male,2008\nAdelie,Biscoe,36.4,17.1,184,2850,female,2008\nAdelie,Biscoe,41.6,18,192,3950,male,2008\nAdelie,Biscoe,35.5,16.2,195,3350,female,2008\nAdelie,Biscoe,41.1,19.1,188,4100,male,2008\nAdelie,Torgersen,35.9,16.6,190,3050,female,2008\nAdelie,Torgersen,41.8,19.4,198,4450,male,2008\nAdelie,Torgersen,33.5,19,190,3600,female,2008\nAdelie,Torgersen,39.7,18.4,190,3900,male,2008\nAdelie,Torgersen,39.6,17.2,196,3550,female,2008\nAdelie,Torgersen,45.8,18.9,197,4150,male,2008\nAdelie,Torgersen,35.5,17.5,190,3700,female,2008\nAdelie,Torgersen,42.8,18.5,195,4250,male,2008\nAdelie,Torgersen,40.9,16.8,191,3700,female,2008\nAdelie,Torgersen,37.2,19.4,184,3900,male,2008\nAdelie,Torgersen,36.2,16.1,187,3550,female,2008\nAdelie,Torgersen,42.1,19.1,195,4000,male,2008\nAdelie,Torgersen,34.6,17.2,189,3200,female,2008\nAdelie,Torgersen,42.9,17.6,196,4700,male,2008\nAdelie,Torgersen,36.7,18.8,187,3800,female,2008\nAdelie,Torgersen,35.1,19.4,193,4200,male,2008\nAdelie,Dream,37.3,17.8,191,3350,female,2008\nAdelie,Dream,41.3,20.3,194,3550,male,2008\nAdelie,Dream,36.3,19.5,190,3800,male,2008\nAdelie,Dream,36.9,18.6,189,3500,female,2008\nAdelie,Dream,38.3,19.2,189,3950,male,2008\nAdelie,Dream,38.9,18.8,190,3600,female,2008\nAdelie,Dream,35.7,18,202,3550,female,2008\nAdelie,Dream,41.1,18.1,205,4300,male,2008\nAdelie,Dream,34,17.1,185,3400,female,2008\nAdelie,Dream,39.6,18.1,186,4450,male,2008\nAdelie,Dream,36.2,17.3,187,3300,female,2008\nAdelie,Dream,40.8,18.9,208,4300,male,2008\nAdelie,Dream,38.1,18.6,190,3700,female,2008\nAdelie,Dream,40.3,18.5,196,4350,male,2008\nAdelie,Dream,33.1,16.1,178,2900,female,2008\nAdelie,Dream,43.2,18.5,192,4100,male,2008\nAdelie,Biscoe,35,17.9,192,3725,female,2009\nAdelie,Biscoe,41,20,203,4725,male,2009\nAdelie,Biscoe,37.7,16,183,3075,female,2009\nAdelie,Biscoe,37.8,20,190,4250,male,2009\nAdelie,Biscoe,37.9,18.6,193,2925,female,2009\nAdelie,Biscoe,39.7,18.9,184,3550,male,2009\nAdelie,Biscoe,38.6,17.2,199,3750,female,2009\nAdelie,Biscoe,38.2,20,190,3900,male,2009\nAdelie,Biscoe,38.1,17,181,3175,female,2009\nAdelie,Biscoe,43.2,19,197,4775,male,2009\nAdelie,Biscoe,38.1,16.5,198,3825,female,2009\nAdelie,Biscoe,45.6,20.3,191,4600,male,2009\nAdelie,Biscoe,39.7,17.7,193,3200,female,2009\nAdelie,Biscoe,42.2,19.5,197,4275,male,2009\nAdelie,Biscoe,39.6,20.7,191,3900,female,2009\nAdelie,Biscoe,42.7,18.3,196,4075,male,2009\nAdelie,Torgersen,38.6,17,188,2900,female,2009\nAdelie,Torgersen,37.3,20.5,199,3775,male,2009\nAdelie,Torgersen,35.7,17,189,3350,female,2009\nAdelie,Torgersen,41.1,18.6,189,3325,male,2009\nAdelie,Torgersen,36.2,17.2,187,3150,female,2009\nAdelie,Torgersen,37.7,19.8,198,3500,male,2009\nAdelie,Torgersen,40.2,17,176,3450,female,2009\nAdelie,Torgersen,41.4,18.5,202,3875,male,2009\nAdelie,Torgersen,35.2,15.9,186,3050,female,2009\nAdelie,Torgersen,40.6,19,199,4000,male,2009\nAdelie,Torgersen,38.8,17.6,191,3275,female,2009\nAdelie,Torgersen,41.5,18.3,195,4300,male,2009\nAdelie,Torgersen,39,17.1,191,3050,female,2009\nAdelie,Torgersen,44.1,18,210,4000,male,2009\nAdelie,Torgersen,38.5,17.9,190,3325,female,2009\nAdelie,Torgersen,43.1,19.2,197,3500,male,2009\nAdelie,Dream,36.8,18.5,193,3500,female,2009\nAdelie,Dream,37.5,18.5,199,4475,male,2009\nAdelie,Dream,38.1,17.6,187,3425,female,2009\nAdelie,Dream,41.1,17.5,190,3900,male,2009\nAdelie,Dream,35.6,17.5,191,3175,female,2009\nAdelie,Dream,40.2,20.1,200,3975,male,2009\nAdelie,Dream,37,16.5,185,3400,female,2009\nAdelie,Dream,39.7,17.9,193,4250,male,2009\nAdelie,Dream,40.2,17.1,193,3400,female,2009\nAdelie,Dream,40.6,17.2,187,3475,male,2009\nAdelie,Dream,32.1,15.5,188,3050,female,2009\nAdelie,Dream,40.7,17,190,3725,male,2009\nAdelie,Dream,37.3,16.8,192,3000,female,2009\nAdelie,Dream,39,18.7,185,3650,male,2009\nAdelie,Dream,39.2,18.6,190,4250,male,2009\nAdelie,Dream,36.6,18.4,184,3475,female,2009\nAdelie,Dream,36,17.8,195,3450,female,2009\nAdelie,Dream,37.8,18.1,193,3750,male,2009\nAdelie,Dream,36,17.1,187,3700,female,2009\nAdelie,Dream,41.5,18.5,201,4000,male,2009\nGentoo,Biscoe,46.1,13.2,211,4500,female,2007\nGentoo,Biscoe,50,16.3,230,5700,male,2007\nGentoo,Biscoe,48.7,14.1,210,4450,female,2007\nGentoo,Biscoe,50,15.2,218,5700,male,2007\nGentoo,Biscoe,47.6,14.5,215,5400,male,2007\nGentoo,Biscoe,46.5,13.5,210,4550,female,2007\nGentoo,Biscoe,45.4,14.6,211,4800,female,2007\nGentoo,Biscoe,46.7,15.3,219,5200,male,2007\nGentoo,Biscoe,43.3,13.4,209,4400,female,2007\nGentoo,Biscoe,46.8,15.4,215,5150,male,2007\nGentoo,Biscoe,40.9,13.7,214,4650,female,2007\nGentoo,Biscoe,49,16.1,216,5550,male,2007\nGentoo,Biscoe,45.5,13.7,214,4650,female,2007\nGentoo,Biscoe,48.4,14.6,213,5850,male,2007\nGentoo,Biscoe,45.8,14.6,210,4200,female,2007\nGentoo,Biscoe,49.3,15.7,217,5850,male,2007\nGentoo,Biscoe,42,13.5,210,4150,female,2007\nGentoo,Biscoe,49.2,15.2,221,6300,male,2007\nGentoo,Biscoe,46.2,14.5,209,4800,female,2007\nGentoo,Biscoe,48.7,15.1,222,5350,male,2007\nGentoo,Biscoe,50.2,14.3,218,5700,male,2007\nGentoo,Biscoe,45.1,14.5,215,5000,female,2007\nGentoo,Biscoe,46.5,14.5,213,4400,female,2007\nGentoo,Biscoe,46.3,15.8,215,5050,male,2007\nGentoo,Biscoe,42.9,13.1,215,5000,female,2007\nGentoo,Biscoe,46.1,15.1,215,5100,male,2007\nGentoo,Biscoe,44.5,14.3,216,4100,NA,2007\nGentoo,Biscoe,47.8,15,215,5650,male,2007\nGentoo,Biscoe,48.2,14.3,210,4600,female,2007\nGentoo,Biscoe,50,15.3,220,5550,male,2007\nGentoo,Biscoe,47.3,15.3,222,5250,male,2007\nGentoo,Biscoe,42.8,14.2,209,4700,female,2007\nGentoo,Biscoe,45.1,14.5,207,5050,female,2007\nGentoo,Biscoe,59.6,17,230,6050,male,2007\nGentoo,Biscoe,49.1,14.8,220,5150,female,2008\nGentoo,Biscoe,48.4,16.3,220,5400,male,2008\nGentoo,Biscoe,42.6,13.7,213,4950,female,2008\nGentoo,Biscoe,44.4,17.3,219,5250,male,2008\nGentoo,Biscoe,44,13.6,208,4350,female,2008\nGentoo,Biscoe,48.7,15.7,208,5350,male,2008\nGentoo,Biscoe,42.7,13.7,208,3950,female,2008\nGentoo,Biscoe,49.6,16,225,5700,male,2008\nGentoo,Biscoe,45.3,13.7,210,4300,female,2008\nGentoo,Biscoe,49.6,15,216,4750,male,2008\nGentoo,Biscoe,50.5,15.9,222,5550,male,2008\nGentoo,Biscoe,43.6,13.9,217,4900,female,2008\nGentoo,Biscoe,45.5,13.9,210,4200,female,2008\nGentoo,Biscoe,50.5,15.9,225,5400,male,2008\nGentoo,Biscoe,44.9,13.3,213,5100,female,2008\nGentoo,Biscoe,45.2,15.8,215,5300,male,2008\nGentoo,Biscoe,46.6,14.2,210,4850,female,2008\nGentoo,Biscoe,48.5,14.1,220,5300,male,2008\nGentoo,Biscoe,45.1,14.4,210,4400,female,2008\nGentoo,Biscoe,50.1,15,225,5000,male,2008\nGentoo,Biscoe,46.5,14.4,217,4900,female,2008\nGentoo,Biscoe,45,15.4,220,5050,male,2008\nGentoo,Biscoe,43.8,13.9,208,4300,female,2008\nGentoo,Biscoe,45.5,15,220,5000,male,2008\nGentoo,Biscoe,43.2,14.5,208,4450,female,2008\nGentoo,Biscoe,50.4,15.3,224,5550,male,2008\nGentoo,Biscoe,45.3,13.8,208,4200,female,2008\nGentoo,Biscoe,46.2,14.9,221,5300,male,2008\nGentoo,Biscoe,45.7,13.9,214,4400,female,2008\nGentoo,Biscoe,54.3,15.7,231,5650,male,2008\nGentoo,Biscoe,45.8,14.2,219,4700,female,2008\nGentoo,Biscoe,49.8,16.8,230,5700,male,2008\nGentoo,Biscoe,46.2,14.4,214,4650,NA,2008\nGentoo,Biscoe,49.5,16.2,229,5800,male,2008\nGentoo,Biscoe,43.5,14.2,220,4700,female,2008\nGentoo,Biscoe,50.7,15,223,5550,male,2008\nGentoo,Biscoe,47.7,15,216,4750,female,2008\nGentoo,Biscoe,46.4,15.6,221,5000,male,2008\nGentoo,Biscoe,48.2,15.6,221,5100,male,2008\nGentoo,Biscoe,46.5,14.8,217,5200,female,2008\nGentoo,Biscoe,46.4,15,216,4700,female,2008\nGentoo,Biscoe,48.6,16,230,5800,male,2008\nGentoo,Biscoe,47.5,14.2,209,4600,female,2008\nGentoo,Biscoe,51.1,16.3,220,6000,male,2008\nGentoo,Biscoe,45.2,13.8,215,4750,female,2008\nGentoo,Biscoe,45.2,16.4,223,5950,male,2008\nGentoo,Biscoe,49.1,14.5,212,4625,female,2009\nGentoo,Biscoe,52.5,15.6,221,5450,male,2009\nGentoo,Biscoe,47.4,14.6,212,4725,female,2009\nGentoo,Biscoe,50,15.9,224,5350,male,2009\nGentoo,Biscoe,44.9,13.8,212,4750,female,2009\nGentoo,Biscoe,50.8,17.3,228,5600,male,2009\nGentoo,Biscoe,43.4,14.4,218,4600,female,2009\nGentoo,Biscoe,51.3,14.2,218,5300,male,2009\nGentoo,Biscoe,47.5,14,212,4875,female,2009\nGentoo,Biscoe,52.1,17,230,5550,male,2009\nGentoo,Biscoe,47.5,15,218,4950,female,2009\nGentoo,Biscoe,52.2,17.1,228,5400,male,2009\nGentoo,Biscoe,45.5,14.5,212,4750,female,2009\nGentoo,Biscoe,49.5,16.1,224,5650,male,2009\nGentoo,Biscoe,44.5,14.7,214,4850,female,2009\nGentoo,Biscoe,50.8,15.7,226,5200,male,2009\nGentoo,Biscoe,49.4,15.8,216,4925,male,2009\nGentoo,Biscoe,46.9,14.6,222,4875,female,2009\nGentoo,Biscoe,48.4,14.4,203,4625,female,2009\nGentoo,Biscoe,51.1,16.5,225,5250,male,2009\nGentoo,Biscoe,48.5,15,219,4850,female,2009\nGentoo,Biscoe,55.9,17,228,5600,male,2009\nGentoo,Biscoe,47.2,15.5,215,4975,female,2009\nGentoo,Biscoe,49.1,15,228,5500,male,2009\nGentoo,Biscoe,47.3,13.8,216,4725,NA,2009\nGentoo,Biscoe,46.8,16.1,215,5500,male,2009\nGentoo,Biscoe,41.7,14.7,210,4700,female,2009\nGentoo,Biscoe,53.4,15.8,219,5500,male,2009\nGentoo,Biscoe,43.3,14,208,4575,female,2009\nGentoo,Biscoe,48.1,15.1,209,5500,male,2009\nGentoo,Biscoe,50.5,15.2,216,5000,female,2009\nGentoo,Biscoe,49.8,15.9,229,5950,male,2009\nGentoo,Biscoe,43.5,15.2,213,4650,female,2009\nGentoo,Biscoe,51.5,16.3,230,5500,male,2009\nGentoo,Biscoe,46.2,14.1,217,4375,female,2009\nGentoo,Biscoe,55.1,16,230,5850,male,2009\nGentoo,Biscoe,44.5,15.7,217,4875,NA,2009\nGentoo,Biscoe,48.8,16.2,222,6000,male,2009\nGentoo,Biscoe,47.2,13.7,214,4925,female,2009\nGentoo,Biscoe,NA,NA,NA,NA,NA,2009\nGentoo,Biscoe,46.8,14.3,215,4850,female,2009\nGentoo,Biscoe,50.4,15.7,222,5750,male,2009\nGentoo,Biscoe,45.2,14.8,212,5200,female,2009\nGentoo,Biscoe,49.9,16.1,213,5400,male,2009\nChinstrap,Dream,46.5,17.9,192,3500,female,2007\nChinstrap,Dream,50,19.5,196,3900,male,2007\nChinstrap,Dream,51.3,19.2,193,3650,male,2007\nChinstrap,Dream,45.4,18.7,188,3525,female,2007\nChinstrap,Dream,52.7,19.8,197,3725,male,2007\nChinstrap,Dream,45.2,17.8,198,3950,female,2007\nChinstrap,Dream,46.1,18.2,178,3250,female,2007\nChinstrap,Dream,51.3,18.2,197,3750,male,2007\nChinstrap,Dream,46,18.9,195,4150,female,2007\nChinstrap,Dream,51.3,19.9,198,3700,male,2007\nChinstrap,Dream,46.6,17.8,193,3800,female,2007\nChinstrap,Dream,51.7,20.3,194,3775,male,2007\nChinstrap,Dream,47,17.3,185,3700,female,2007\nChinstrap,Dream,52,18.1,201,4050,male,2007\nChinstrap,Dream,45.9,17.1,190,3575,female,2007\nChinstrap,Dream,50.5,19.6,201,4050,male,2007\nChinstrap,Dream,50.3,20,197,3300,male,2007\nChinstrap,Dream,58,17.8,181,3700,female,2007\nChinstrap,Dream,46.4,18.6,190,3450,female,2007\nChinstrap,Dream,49.2,18.2,195,4400,male,2007\nChinstrap,Dream,42.4,17.3,181,3600,female,2007\nChinstrap,Dream,48.5,17.5,191,3400,male,2007\nChinstrap,Dream,43.2,16.6,187,2900,female,2007\nChinstrap,Dream,50.6,19.4,193,3800,male,2007\nChinstrap,Dream,46.7,17.9,195,3300,female,2007\nChinstrap,Dream,52,19,197,4150,male,2007\nChinstrap,Dream,50.5,18.4,200,3400,female,2008\nChinstrap,Dream,49.5,19,200,3800,male,2008\nChinstrap,Dream,46.4,17.8,191,3700,female,2008\nChinstrap,Dream,52.8,20,205,4550,male,2008\nChinstrap,Dream,40.9,16.6,187,3200,female,2008\nChinstrap,Dream,54.2,20.8,201,4300,male,2008\nChinstrap,Dream,42.5,16.7,187,3350,female,2008\nChinstrap,Dream,51,18.8,203,4100,male,2008\nChinstrap,Dream,49.7,18.6,195,3600,male,2008\nChinstrap,Dream,47.5,16.8,199,3900,female,2008\nChinstrap,Dream,47.6,18.3,195,3850,female,2008\nChinstrap,Dream,52,20.7,210,4800,male,2008\nChinstrap,Dream,46.9,16.6,192,2700,female,2008\nChinstrap,Dream,53.5,19.9,205,4500,male,2008\nChinstrap,Dream,49,19.5,210,3950,male,2008\nChinstrap,Dream,46.2,17.5,187,3650,female,2008\nChinstrap,Dream,50.9,19.1,196,3550,male,2008\nChinstrap,Dream,45.5,17,196,3500,female,2008\nChinstrap,Dream,50.9,17.9,196,3675,female,2009\nChinstrap,Dream,50.8,18.5,201,4450,male,2009\nChinstrap,Dream,50.1,17.9,190,3400,female,2009\nChinstrap,Dream,49,19.6,212,4300,male,2009\nChinstrap,Dream,51.5,18.7,187,3250,male,2009\nChinstrap,Dream,49.8,17.3,198,3675,female,2009\nChinstrap,Dream,48.1,16.4,199,3325,female,2009\nChinstrap,Dream,51.4,19,201,3950,male,2009\nChinstrap,Dream,45.7,17.3,193,3600,female,2009\nChinstrap,Dream,50.7,19.7,203,4050,male,2009\nChinstrap,Dream,42.5,17.3,187,3350,female,2009\nChinstrap,Dream,52.2,18.8,197,3450,male,2009\nChinstrap,Dream,45.2,16.6,191,3250,female,2009\nChinstrap,Dream,49.3,19.9,203,4050,male,2009\nChinstrap,Dream,50.2,18.8,202,3800,male,2009\nChinstrap,Dream,45.6,19.4,194,3525,female,2009\nChinstrap,Dream,51.9,19.5,206,3950,male,2009\nChinstrap,Dream,46.8,16.5,189,3650,female,2009\nChinstrap,Dream,45.7,17,195,3650,female,2009\nChinstrap,Dream,55.8,19.8,207,4000,male,2009\nChinstrap,Dream,43.5,18.1,202,3400,female,2009\nChinstrap,Dream,49.6,18.2,193,3775,male,2009\nChinstrap,Dream,50.8,19,210,4100,male,2009\nChinstrap,Dream,50.2,18.7,198,3775,female,2009\n\n## file: README\n1) Add a second plot output to the apps which shows a scatter plot of Bill Depth to Bill Length, there's a plotting function in `plots.py` which provides one implementation.\n2) Add a checkbox which adds a line of best fit to the plot. \n```\n\n\n## Initial state\n\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n    Sl[Slider]  --> Sc \n  Sl --> M((Dist Plot))\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n  linkStyle 2 display:none\n```\n\n\n## Calculate scatter plot\n\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot)):::changed\n    Sl[Slider]  --> Sc \n  Sl --> M((Dist Plot))\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n  linkStyle 2 display:none\n  classDef changed fill:#f96\n```\n\n\n## Calculate scatter plot\n\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot)):::changed\n    Sl[Slider]  --> Sc \n  Sl --> M((Dist Plot))\n  linkStyle 2 display:none\n  classDef changed fill:#f96\n```\n\n\n## Calculate distribution\n\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n    Sl[Slider]  --> Sc \n  Sl --> M((Dist Plot)):::changed\n  linkStyle 2 display:none\n  classDef changed fill:#f96\n```\n\n\n## Calculate distribution\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n    Sl[Slider]  --> Sc \n  Sl --> M((Dist Plot)):::changed\n  classDef changed fill:#f96\n```\n\n\n\n## Reactive graph\n\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n    Sl[Slider]  --> Sc \n  Sl --> M((Dist Plot))\n```\n\n\n\n## Slider changes\n\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n  Sl[Slider]:::changed --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n```\n\n\n## Invalidated\n\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot)):::changed\n  Sl[Slider]:::changed --> Sc \n  Sl --> M((Dist Plot)):::changed\n  \n  classDef changed fill:#f96\n```\n\n\n## Forget dependencies\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n  linkStyle 2 display:none\n```\n\n\n## Recalculate\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot)):::changed\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n  linkStyle 2 display:none\n```\n\n\n## Recalculate\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot)):::changed\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n  linkStyle 2 display:none\n```\n\n\n\n## Recalculate\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot)):::changed\n  \n  classDef changed fill:#f96\n  linkStyle 2 display:none\n```\n\n\n## Recalculate\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot)):::changed\n  \n  classDef changed fill:#f96\n```\n\n\n## Updated\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n```\n\n\n## Checkbox changes\n\n```{mermaid}\nflowchart TD\n  C[Checkbox]:::changed --> Sc((Scatter\\nPlot))\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n```\n\n\n## Invalidated\n\n\n```{mermaid}\nflowchart TD\n  C[Checkbox]:::changed --> Sc((Scatter\\nPlot)):::changed\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n```\n\n\n## Forget dependencies\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot)):::changed\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n```\n\n\n## Recalculate\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot)):::changed\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n```\n\n\n## Recalculate\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot)):::changed\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n```\n\n\n## Updated\n\n```{mermaid}\nflowchart TD\n  C[Checkbox] --> Sc((Scatter\\nPlot))\n  Sl[Slider] --> Sc \n  Sl --> M((Dist Plot))\n  \n  classDef changed fill:#f96\n```\n\n\n## Reactivity scales\n\n- Every Shiny app uses this pattern\n- Works for dynamic UIs\n- Shiny is lazy \n\n# Reactive calculations\n\n## Saving and reusing calculated values\n\n- So far we've been working with shallow reactive graphs\n- Each input is passed to a rendering function which produces an output\n- Input -> Recipe -> Output can produce repetitive, inefficient applications\n- `@reactive.Calc` creates calculations whose results can be used by one _or more_ outputs\n- This adds intermediate nodes to the reactive graph\n\n## Reactive Calc example\n\n```{shinylive-python}\n#| standalone: true\n#| components: [editor, viewer]\n#| layout: horizontal\n#| viewerHeight: 800\nfrom shiny import Inputs, Outputs, Session, App, reactive, render, req, ui\nimport pandas as pd\nfrom plotnine import ggplot, geom_histogram, labs, aes\nimport numpy as np\n\napp_ui = ui.page_fluid(\n    ui.input_slider(\"n_rows\", \"Sample rows\", 0, 100, 20),\n    ui.output_plot(\"hist\"),\n    ui.output_table(\"df\"),\n)\n\n\ndef server(input: Inputs, output: Outputs, session: Session):\n    @output\n    @render.table\n    def df():\n        rand = np.random.rand(input.n_rows(), 1)\n        df = pd.DataFrame(rand, columns=[\"col_1\"])\n        return df\n\n    @output\n    @render.plot\n    def hist():\n        rand = np.random.rand(input.n_rows(), 1)\n        df = pd.DataFrame(rand, columns=[\"col_1\"])\n        plot = (\n            ggplot(df, aes(x=\"col_1\"))\n            + geom_histogram(binwidth=0.1, fill=\"blue\", color=\"black\")\n            + labs(x=\"Random Values\", y=\"Frequency\", title=\"Histogram of Random Data\")\n        )\n        return plot\n\n\napp = App(app_ui, server)\n\n```\n\n\n## Identify repetition\n```{.python code-line-numbers=\"4,5,11,12\"}\n    @output\n    @render.table\n    def df():\n        rand = np.random.rand(input.n_rows(), 1)\n        df = pd.DataFrame(rand, columns=[\"col_1\"])\n        return df\n\n    @output\n    @render.plot\n    def hist():\n        rand = np.random.rand(input.n_rows(), 1)\n        df = pd.DataFrame(rand, columns=[\"col_1\"])\n        plot = (\n            ggplot(df, aes(x=\"col_1\"))\n            + geom_histogram(binwidth=0.1, fill=\"blue\", color=\"black\")\n            + labs(x=\"Random Values\", y=\"Frequency\", title=\"Histogram of Random Data\")\n        )\n        return plot\n```\n\n## Problems with repetition\n\n1) Code is in multiple places\n2) The app is taking the sample twice\n3) The table and graph are not using the same sample!\n\n## Reactive Calculation to the rescue\n```{.python code-line-numbers=\"1-4,9,15\"}\n    @reactive.Calc\n    def sampled_df():\n        rand = np.random.rand(input.n_rows(), 1)\n        df = pd.DataFrame(rand, columns=[\"col_1\"])\n\n    @output\n    @render.table\n    def df():\n        return sampled_df()\n\n    @output\n    @render.plot\n    def hist():\n        plot = (\n            ggplot(sampled_df(), aes(x=\"col_1\"))\n            + geom_histogram(binwidth=0.1, fill=\"blue\", color=\"black\")\n            + labs(x=\"Random Values\", y=\"Frequency\", title=\"Histogram of Random Data\")\n        )\n        return plot\n```\n\n## Reactive calculations\n- Defined with the `@reactive.Calc` decorator\n- Called like other inputs\n- Can read inputs, reactive values, or other reactive calculations\n- Caches its value, so it's cheap to call repeatedly\n- Adds a node to the reactive graph\n  - Discards cached value when upstream nodes invalidate\n  - Notifies downstream nodes when it invalidates\n\n## Initial state\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n  linkStyle 2 display:none\n```\n\n\n## Calculate table\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]:::changed\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n  linkStyle 2 display:none\n```\n\n\n## Calculate table\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]:::changed\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 2 display:none\n```\n\n\n## Calculate sample\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]:::changed\n  S --> T[Table]:::changed\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 2 display:none\n```\n\n\n## Calculate sample\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]:::changed\n  S --> T[Table]:::changed\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 2 display:none\n```\n\n\n## Calculate plot\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]\n  S --> P[Plot]:::changed\n  \n  classDef changed fill:#f96\n  linkStyle 2 display:none\n```\n\n\n## Calculate plot\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]\n  S --> P[Plot]:::changed\n  \n  classDef changed fill:#f96\n```\n\n\n## Deep reactive graph\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n```\n\n\n## Slider changes\n\n\n```{mermaid}\nflowchart TD\n  Sl[Slider]:::changed --> S[Sample]\n  S --> T[Table]\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n```\n\n\n## Invalidated\n\n```{mermaid}\nflowchart TD\n  Sl[Slider]:::changed --> S[Sample]:::changed\n  S --> T[Table]\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n```\n\n\n## Invalidated\n\n```{mermaid}\nflowchart TD\n  Sl[Slider]:::changed --> S[Sample]:::changed\n  S --> T[Table]:::changed\n  S --> P[Plot]:::changed\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n  linkStyle 2 display:none\n```\n\n\n## Recalculate table\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]:::changed\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 1 display:none\n  linkStyle 2 display:none\n```\n\n\n## Recalculate table\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]:::changed\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 2 display:none\n```\n\n\n## Recalculate sample\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]:::changed\n  S --> T[Table]:::changed\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 0 display:none\n  linkStyle 2 display:none\n```\n\n\n## Recalculate sample\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]:::changed\n  S --> T[Table]:::changed\n  S --> P[Plot]\n  \n  classDef changed fill:#f96\n  linkStyle 2 display:none\n```\n\n\n## Recalculate plot\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]\n  S --> P[Plot]:::changed\n  \n  classDef changed fill:#f96\n  linkStyle 2 display:none\n```\n\n\n## Recalculate plot\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]\n  S --> P[Plot]:::changed\n  \n  classDef changed fill:#f96\n```\n\n\n## Updated\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S --> T[Table]\n  S --> P[Plot]\n  classDef changed fill:#f96\n```\n\n\n\n## Your turn\n\nGo to [exercises/5-reactivity](../exercises/5-reactivity.html) or run `apps/core/exercises/5-reactivity` locally.\n\n\n## Exercise 2.3 answer \n\n\n```{mermaid}\nflowchart TD\n  Sl[Slider] --> S[Sample]\n  S[Sample] --> F[Filter]\n  F --> T((Table))\n  S --> P((Plot))\n  F --> Tx((Text))\n  classDef changed fill:#f96\n```\n\n\n# Overriding reactivity\n\n- By default, when an input changes, any outputs that use it will recalculate\n- This isn't always the user interaction you want\n    - Database queries\n    - Expensive modeling\n    - Grouping multiple filters together\n    - Side effects\n- Use `reactive.event` to explicitly specify what should trigger recalculation for an output or calc\n\n## Example\n\n```{shinylive-python}\n#| standalone: true\n#| components: [viewer]\n#| layout: horizontal\n#| viewerHeight: 500\nfrom shiny import Inputs, Outputs, Session, App, reactive, render, req, ui\n\napp_ui = ui.page_fluid(\n    ui.input_text(\"input_txt\", \"Enter text\"),\n    ui.input_action_button(\"send\", \"Enter\"),\n    ui.output_text_verbatim(\"output_txt\"),\n)\n\n\ndef server(input, output, session):\n    @output\n    @render.text\n    @reactive.event(input.send)\n    def output_txt():\n        return input.input_txt()\n\n\napp = App(app_ui, server)\n\n## file: README\nAdd an `input.action_button` to the app, and use `@reactive.event` to prevent the text from printing until the user presses the button.\n```\n\n\n## reactive.event\n```{.python}\n@output\n@render.text\n@reactive.event(input.my_input)\ndef txt():\n  return \"Here is my text\"\n```\n\n- `@reactive.event` overrides the usual _implicit_ dependency detection with an _explicit_ trigger\n- It can be applied to rendering functions or to `@reactive.Calc`\n- It tells Shiny to invalidate the object whenever or more inputs change\n- `@reactive.event` is often used with action buttons or action links\n\n## Your turn\n\nGo to [exercises/6-reactive-event](../exercises/6-reactive-event.html) or run `apps/core/2-reactivity/2.3-reactive-event` locally.\n\n\n# Side effects\n\n## What we've learned\n- How Shiny re-renders elements \n- How Shiny detects dependencies between elements (inputs and outputs)\n- How to create reusable calculations with `@reactive.Calc`\n- How to explicitly control reactivity with `@reactive.event`\n\n## Is that enough?\n- Shiny has a function `ui.show_modal` which triggers a modal window. \n- Using what you know so far, how would you call this function?\n\n```{shinylive-python}\n#| standalone: true\n#| components: [viewer]\n#| layout: horizontal\n#| viewerHeight: 500\nfrom shiny import App, Inputs, Outputs, Session, reactive, ui, render\n\napp_ui = ui.page_fluid(\n    ui.input_action_button(\"show\", \"Show modal dialog\"), ui.output_text(\"txt\")\n)\n\n\ndef server(input: Inputs, output: Outputs, session: Session):\n    @reactive.Effect\n    @reactive.event(input.show)\n    def show_modal():\n        m = ui.modal(\n            \"This is a somewhat important message.\",\n            title=\"Click outside the modal to close\",\n            easy_close=True,\n            footer=None,\n        )\n        ui.modal_show(m)\n\n\napp = App(app_ui, server)\n\n```\n\n\n## Return values vs. side effects\n- Inputs, outputs, and calculations all produce values\n- When an input value changes, downstream calculations and outputs might need to have their values updated as well\n- But sometimes we want to execute some code that doesn't produce a value\n  - Doesn't fit in the categories of \"calculation\" or \"output\"\n\n## Reactive Effects\n- The `@reactive.Effect` decorator allows you to react to an input without returning a value\n- Usually paired with `@reactive.event` \n\n``` {.python}\n@reactive.Effect\n@reactive.event(input.show)\ndef toggle_modal():\n    m = ui.modal(\n        \"This is a somewhat important message.\",\n        title=\"Click outside the modal to close\",\n        easy_close=True,\n        footer=None,\n    )\n    ui.modal_show(m)\n```\n\n## The rule\n\n* Code that produces an output: `@output` + `@render.*`\n* Code that produces an intermediate value: `@reactive.Calc`\n* **Code that produces only side effects: `@reactive.Effect`**\n\n. . .\n\n::: nonincremental\n* Code that produces a value _and_ a side effect: _Don't do this!_\n  * The \"command-query separation\" principle\n:::\n\n## What's a side effect?\n\n\n\n::: {#1381ac29 .cell execution_count=8}\n\n::: {.cell-output .cell-output-stdout}\n````\n::: callout-note\n## Test your understanding\n```{shinylive-python}\n#| standalone: true\n#| components: [viewer]\n#| layout: horizontal\n#| viewerHeight: 250\nfrom shiny import App, render, ui, reactive, req\nimport json\nfrom pathlib import Path\n\nwith open(Path(__file__).parent / \"questions.json\", \"r\") as file:\n    questions = json.load(file)\n\napp_ui = ui.page_fluid(ui.output_ui(\"question\"), ui.output_ui(\"validation\"))\n\n\ndef server(input, output, session):\n    q_num = reactive.Value(0)\n\n    question_keys = list(questions.keys())\n\n    @reactive.Calc\n    def current_q():\n        return questions[question_keys[q_num()]]\n\n    @output\n    @render.ui\n    def question():\n        return ui.div(\n            ui.h5(question_keys[q_num()], style=\"margin-bottom: 20px\"),\n            ui.input_radio_buttons(\n                \"question\",\n                \"\",\n                choices=current_q()[\"choices\"],\n                selected=\"\",\n            ),\n        )\n\n    @output\n    @render.ui\n    def validation():\n        req(input.question())\n        if input.question() == current_q()[\"answer\"]:\n            if q_num() == len(question_keys) - 1:\n                return ui.p(\"Correct! Quiz complete.\")\n            else:\n                return ui.div(\n                    ui.p(\"Correct!\"), ui.input_action_button(\"next\", \"Next Question\")\n                )\n        return ui.p(\"Not quite right, try again\")\n\n    @reactive.Effect\n    @reactive.event(input.next)\n    def next_question():\n        q_num.set(q_num.get() + 1)\n\n\napp = App(app_ui, server)\n\n## file: questions.json\n{\"Writing a CSV\": {\"choices\": [\"value\", \"side effect\"], \"answer\": \"side effect\"}, \"Querying a database\": {\"choices\": [\"value\", \"side effect\"], \"answer\": \"value\"}, \"Adding two numbers\": {\"choices\": [\"value\", \"side effect\"], \"answer\": \"value\"}, \"A function which prints to the console\": {\"choices\": [\"value\", \"side effect\"], \"answer\": \"side effect\"}, \"Fetching the current temperature from an API\": {\"choices\": [\"value\", \"side effect\"], \"answer\": \"value\"}, \"A function which sorts a list in place\": {\"choices\": [\"value\", \"side effect\"], \"answer\": \"side effect\"}, \"Getting a model score for a set of inputs\": {\"choices\": [\"value\", \"side effect\"], \"answer\": \"value\"}, \"Deploying a model to a hosting service\": {\"choices\": [\"value\", \"side effect\"], \"answer\": \"side effect\"}}\n```\n:::\n````\n:::\n:::\n\n\n## What's a side effect?\n\n- Somewhat context dependent\n- Multiple strategies can work\n- If your solution feels complicated and painful, ask whether you should use the other strategy\n\n## Your turn\n\nGo to [exercises/7-reactive-effects](../exercises/7-reactive-effects.html) or run `apps/core/3-reactive-effects/3.1-update-slider` locally.\n\n",
    "supporting": [
      "reactivity_files"
    ],
    "filters": [],
    "includes": {}
  }
}